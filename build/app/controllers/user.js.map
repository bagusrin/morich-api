{"version":3,"sources":["../src/app/controllers/user.js"],"names":["connection","require","jwt","bcrypt","userModel","generalModel","emailModel","cfg","empty","axios","multer","storage","diskStorage","destination","req","file","cb","filename","mimetype","ext","Date","now","upload","cUser","userRegisterBackup","res","next","body","invitedBy","email","fullName","phoneNumber","status","json","statusCode","message","name","phone","acquire","err","con","checkEmailExist","result","sendEmailRegister","success","release","userRegister","inviterEmail","inviterUsername","oriPassword","getRandomStr","password","hashSync","getUserIdByEmail","userId","getReferalCodeByEmail","referalCode","sql","console","log","query","data","code","splitName","trim","split","length","uname","insertId","toLowerCase","sql3","err3","data3","sql2","err2","data2","updatePointByEmail","userJoin","retypePassword","checkUserReferalCode","userName","userEmail","inviterName","userIdInvitedBy","inviterId","updatePoint","sendEmailCompleteRegister","pp","user_photo","photoProfileUrl","user_firstname","user_lastname","initialName","charAt","toUpperCase","statusAccount","user_id","user_email","user_mobile_number","rank","user_username","total_invited","member_joined","inviter_email","userDetail","params","id","dt","push","user_phone_number","user_line","user_whatsapp","user_facebook","user_instagram","user_wechat","user_country","user_address1","user_address2","user_language","userDetailByUsername","username","userGetIdByEmail","userStatisticByEmail","userUpdate","firstName","mobileNumber","address1","lastName","language","line","whatsapp","facebook","instagram","wechat","country","address2","userUploadPhoto","photoProfile","uploadAction","single","userSubmission","referralEmail","hpWa","city","age","languages","currentOccupation","isExperienceInMobileBusiness","targetMobileBusiness180Days","reason","urgencyLevel","seriousLevel","capitalInvestment","readyToJoin","isAvailableContactToMobile","sendEmailSubmission","userSubmissionBackup","userList","i","app","current_occupation","is_experience_mobile_business","target_mobile_business_180_days","urgency_level","serious_level","capital_investment","ready_to_join","is_available_contact_to_mobile","submit_app_date","userID","user_password","user_invited_by","postDate","userListBackup","activated","isPassword","point","sqlNew","affectedRows","sendTmpPassword","userAdminPost","passwordEncrypt","userIdReferral","sendEmailUserRegisterFromAdmin","userAdminPostBackup","userChangePassword","module","exports"],"mappings":"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","file":"user.js","sourcesContent":["var connection = require('../../../config/db');\n\nvar jwt = require('jsonwebtoken'),\n    bcrypt = require('bcrypt'),\n    userModel = require('../models/user'),\n    generalModel = require('../models/general'),\n    emailModel = require('../models/email'),\n    cfg = require('../../../config'),\n    empty = require('is-empty');\n\nconst axios = require('axios');\nvar multer = require('multer');\n\nvar storage = multer.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, '../public/uploads/users')\n    },\n    filename: (req, file, cb) => {\n\n      switch(file.mimetype){\n        case 'image/jpeg':\n          var ext = '.jpeg';\n        break;\n        case 'image/jpg':\n          var ext = '.jpg';\n        break;\n        case 'image/png':\n          var ext = '.png';\n        break;\n      }\n\n      cb(null, Date.now()+''+ext);\n    }\n});\n\nvar upload = multer({storage: storage});\n \nfunction cUser() {\n\n  this.userRegisterBackup = function(req,res,next) {\n\n    if( empty(req.body.invitedBy) || empty(req.body.email) || empty(req.body.fullName) || empty(req.body.phoneNumber) )\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"}); \n    \n    var invitedBy = req.body.invitedBy,\n        email = req.body.email,\n        name = req.body.fullName,\n        phone = req.body.phoneNumber\n\n    connection.acquire(function(err,con){\n      if (err) throw err;\n\n      userModel.checkEmailExist(con,email,res,function(result){  \n\n        emailModel.sendEmailRegister(email,name,invitedBy);\n        return res.status(200).json({statusCode:200,success:true});\n        \n      });\n\n      con.release();\n\n    });\n  };\n\n  this.userRegister = function(req,res,next) {\n\n    if( empty(req.body.inviterEmail) || empty(req.body.email) || empty(req.body.fullName) || empty(req.body.phoneNumber) )\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"}); \n    \n    var inviterUsername = req.body.inviterUsername,\n        inviterEmail = req.body.inviterEmail,\n        email = req.body.email,\n        name = req.body.fullName,\n        phone = req.body.phoneNumber,\n        oriPassword = generalModel.getRandomStr(),\n        password = bcrypt.hashSync(oriPassword, 10),\n        status = 0;\n\n    connection.acquire(function(err,con){\n      if (err) throw err;\n\n      userModel.checkEmailExist(con,email,res,function(result){  \n\n        userModel.getUserIdByEmail(con,inviterEmail,res,function(result){\n\n          var userId = result.userId;\n\n          userModel.getReferalCodeByEmail(con,inviterEmail,res,function(result){\n\n            var referalCode = result.referalCode;\n\n            /*var sql = \"INSERT INTO users (user_email,user_password,user_firstname,user_lastname,user_mobile_number,user_invited_by,user_referal_code,status,post_date) \\\n                      VALUES ('\"+email+\"','\"+password+\"', '\"+name+\"', '', '\"+phone+\"', '\"+userId+\"', '\"+referalCode+\"', '\"+status+\"', NOW())\";*/\n\n            var sql = \"INSERT INTO users (user_email,user_firstname,user_lastname,user_mobile_number,user_invited_by,user_referal_code,status,post_date) \\\n                      VALUES ('\"+email+\"', '\"+name+\"', '', '\"+phone+\"', '\"+userId+\"', '\"+referalCode+\"', '\"+status+\"', NOW())\";\n\n                      console.log(sql);\n              \n            con.query(sql, function(err,data){\n                \n              if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n\n              var splitName = name.trim().split(\" \");\n              if(splitName.length > 1){\n                var uname = splitName[0]+''+data.insertId;\n              }else{\n                var uname = splitName[0]+''+data.insertId;\n              }\n\n              uname = uname.toLowerCase();\n\n              var sql3 = \"UPDATE users set user_username = '\"+uname+\"', status = 2, update_date = NOW() WHERE user_email = '\"+email+\"'\";\n\n              con.query(sql3, function(err3,data3){\n                if(err)\n                  return res.status(500).json({statusCode:500,message: err3.code});\n\n                var sql2 = \"INSERT INTO conversations (UserID_One, UserID_Two, UserOneStatus, UserTwoStatus, \\\n                          TransactTime) \\\n                          VALUES ('\"+email+\"','\"+inviterEmail+\"','2','2', NOW())\";\n\n                con.query(sql2, function(err2,data2){\n                  if(err2)\n                    return res.status(500).json({statusCode:500,message: err2.code});\n\n                  userModel.updatePointByEmail(con,inviterEmail,1,res,function(result){\n                    //emailModel.sendEmailRegister(email,referalCode,oriPassword)\n                    emailModel.sendEmailRegister(email,name,inviterUsername);\n                    return res.status(200).json({statusCode:200,success:true,data:{\"userId\":data.insertId}});\n                  });\n                });\n              });                \n            });\n          });      \n        });\n      });\n\n      con.release();\n\n    });\n  };\n\n  this.userJoin = function(req,res,next) {\n\n    if( empty(req.body.invitedBy) || empty(req.body.email) || empty(req.body.password) || empty(req.body.retypePassword) )\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"}); \n     \n    var invitedBy = req.body.invitedBy,\n        email = req.body.email,\n        password = bcrypt.hashSync(req.body.password, 10),\n        retypePassword = req.body.retypePassword;\n\n    if(req.body.password != req.body.retypePassword)\n      return res.status(500).json({statusCode:500,message: \"Password doesn't match\"});\n\n    \n    connection.acquire(function(err,con){\n\n\n      userModel.checkUserReferalCode(con,email,invitedBy,res,function(result){\n\n        var userName = result.userName;\n        var userEmail = result.userEmail;\n        var userId = result.userId;\n        var inviterName = result.inviterName;\n        var inviterEmail = result.inviterEmail;\n        var userIdInvitedBy = result.inviterId;\n\n        var splitName = userName.trim().split(\" \");\n\n        if(splitName.length > 1){\n          var uname = splitName[0]+''+userId;\n        }else{\n          var uname = splitName[0]+''+userId;\n        }\n\n        uname = uname.toLowerCase();  \n\n        var sql = \"UPDATE users set user_username = '\"+uname+\"', user_password = '\"+password+\"', status = 2, update_date = NOW() WHERE user_email = '\"+email+\"'\";\n          \n        con.query(sql, function(err,data){\n            if(err)\n              return res.status(500).json({statusCode:500,message: err.code});\n\n            var sql2 = \"INSERT INTO conversations (UserID_One, UserID_Two, UserOneStatus, UserTwoStatus, \\\n            TransactTime) \\\n            VALUES ('\"+userEmail+\"','\"+inviterEmail+\"','2','2', NOW())\";\n\n            con.query(sql2, function(err2,data2){\n              if(err2)\n                return res.status(500).json({statusCode:500,message: err2.code});\n              \n              userModel.updatePoint(con,userIdInvitedBy,1,res,function(result){\n                emailModel.sendEmailCompleteRegister(userName,userEmail,inviterName,inviterEmail);\n\n                var sql3 = \"SELECT *, user_id as id, user_invited_by as invited_id, (select count(user_id) from users WHERE user_invited_by = id) as total_invited, (select user_email FROM users WHERE user_id = invited_id) as inviter_email, \\\n                          (select count(user_id) from users WHERE user_invited_by = id AND status <> '0') as member_joined, FIND_IN_SET( user_point, (SELECT GROUP_CONCAT( user_point ORDER BY user_point DESC ) FROM users )) \\\n                      AS rank FROM users WHERE user_email = '\"+email+\"' LIMIT 1\";\n\n                con.query(sql3, function(err3,data3){\n                  if(err3)\n                    return res.status(500).json({statusCode:500,message: err3.code});\n\n                  var pp = (data3[0].user_photo) ? cfg.photoProfileUrl+''+data3[0].user_photo : null;\n                  var fullName = data3[0].user_firstname+' '+data3[0].user_lastname;\n\n                  var splitName = fullName.trim().split(\" \");\n\n                  if(splitName.length > 1){\n                    var initialName = splitName[0].charAt(0)+''+splitName[1].charAt(0);\n                  }else{\n                    var initialName = splitName[0].charAt(0);\n                  }\n\n                  initialName = initialName.toUpperCase();\n                  //var isActive = (data3[0].status == 1) ? true : false;\n\n                  var statusAccount = \"\";\n\n                  if(data3[0].status == 0){\n                    statusAccount = \"not active\";\n                  }\n\n                  if(data3[0].status == 1){\n                    statusAccount = \"regular\";\n                  }\n\n                  if(data3[0].status == 2){\n                    statusAccount = \"potential\";\n                  }\n\n                  if(data3[0].status == 3){\n                    statusAccount = \"premium\";\n                  }\n\n                  return res.status(200).json({\n                                  statusCode:200,\n                                  success:true,\n                                  data:{\n                                    \"userId\":data3[0].user_id,\n                                    \"email\":data3[0].user_email,\n                                    \"firstName\":data3[0].user_firstname,\n                                    \"lastName\":data3[0].user_lastname,\n                                    \"mobileNumber\":data3[0].user_mobile_number,\n                                    \"photoUrl\": pp,\n                                    \"initialName\": initialName,\n                                    \"ranking\": data3[0].rank,\n                                    \"url\": \"https://morichworldwide.com/\"+data3[0].user_username,\n                                    \"totalInvited\": data3[0].total_invited,\n                                    \"memberJoined\": data3[0].member_joined,\n                                    //\"isActive\": isActive,\n                                    \"accountStatus\": statusAccount,\n                                    \"emailInviter\": data3[0].inviter_email\n                                  }\n                              });\n                });\n                \n              });\n            });\n        });\n\n          con.release();\n      });\n\n    \n    });\n  };\n\n  this.userDetail = function(req,res,next) {\n     connection.acquire(function(err,con){\n        if (err) throw err;\n\n          var sql = 'SELECT *, user_id as id, user_invited_by as invited_id, (select count(user_id) from users WHERE user_invited_by = id) as total_invited, (select user_email FROM users WHERE user_id = invited_id) as inviter_email, \\\n            (select count(user_id) from users WHERE user_invited_by = id AND status <> \"0\") as member_joined, FIND_IN_SET( user_point, (SELECT GROUP_CONCAT( user_point ORDER BY user_point DESC ) FROM users )) \\\n            AS rank FROM users WHERE user_id='+req.params.id+' LIMIT 1'\n          \n          //console.log(sql);\n          con.query(sql, function(err,data){\n            con.release();\n            if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n\n            if(data.length < 1){\n              res.status(404).json({statusCode:404,message: \"Data not found\"});\n            }else{\n              \n              var dt = [];\n              var pp = (data[0].user_photo) ? cfg.photoProfileUrl+''+data[0].user_photo : null;\n\n              var fullName = data[0].user_firstname+' '+data[0].user_lastname;\n\n              var splitName = fullName.trim().split(\" \");\n\n              if(splitName.length > 1){\n                var initialName = splitName[0].charAt(0)+''+splitName[1].charAt(0);\n              }else{\n                var initialName = splitName[0].charAt(0);\n              }\n\n              initialName = initialName.toUpperCase();\n\n              var statusAccount = \"\";\n\n              if(data[0].status == 0){\n                statusAccount = \"not active\";\n              }\n\n              if(data[0].status == 1){\n                statusAccount = \"regular\";\n              }\n\n              if(data[0].status == 2){\n                statusAccount = \"potential\";\n              }\n\n              if(data[0].status == 3){\n                statusAccount = \"premium\";\n              }\n\n              dt.push({\n                \"userId\": data[0].user_id,\n                \"email\": data[0].user_email,\n                \"firstName\": data[0].user_firstname,\n                \"lastName\": data[0].user_lastname,\n                \"initialName\": initialName,\n                \"photoUrl\": pp,\n                \"mobileNumber\": data[0].user_mobile_number,\n                \"phoneNumber\": data[0].user_phone_number,\n                \"line\": data[0].user_line,\n                \"whatsapp\": data[0].user_whatsapp,\n                \"facebook\": data[0].user_facebook,\n                \"instagram\": data[0].user_instagram,\n                \"wechat\": data[0].user_wechat,\n                \"country\": data[0].user_country,\n                \"address1\": data[0].user_address1,\n                \"address2\": data[0].user_address2,\n                \"language\": data[0].user_language,\n                \"ranking\": data[0].rank,\n                \"url\": \"https://morichworldwide.com/\"+data[0].user_username,\n                \"totalInvited\": data[0].total_invited,\n                \"memberJoined\": data[0].member_joined,\n                \"emailInviter\": data[0].inviter_email,\n                \"accountStatus\": statusAccount\n              });\n\n              return res.status(200).json({statusCode:200,success:true,data:dt[0]});\n            }\n        });\n     });\n  };\n\n  this.userDetailByUsername = function(req,res,next) {\n     connection.acquire(function(err,con){\n        if (err) throw err;\n          con.query('SELECT *, FIND_IN_SET( user_point, (SELECT GROUP_CONCAT( user_point ORDER BY user_point DESC ) FROM users )) \\\n        AS rank FROM users WHERE user_username=\"'+req.params.username+'\" LIMIT 1', function(err,data){\n            con.release();\n            if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n\n            if(data.length < 1){\n              res.status(404).json({statusCode:404,message: \"Data not found\"});\n            }else{\n              \n              var dt = [];\n              var pp = (data[0].user_photo) ? cfg.photoProfileUrl+''+data[0].user_photo : null;\n\n              var fullName = data[0].user_firstname+' '+data[0].user_lastname;\n\n              var splitName = fullName.trim().split(\" \");\n\n              if(splitName.length > 1){\n                var initialName = splitName[0].charAt(0)+''+splitName[1].charAt(0);\n              }else{\n                var initialName = splitName[0].charAt(0);\n              }\n\n              initialName = initialName.toUpperCase();\n\n              dt.push({\n                \"userId\": data[0].user_id,\n                \"email\": data[0].user_email,\n                \"firstName\": data[0].user_firstname,\n                \"lastName\": data[0].user_lastname,\n                \"initialName\": initialName,\n                \"photoUrl\": pp,\n                \"mobileNumber\": data[0].user_mobile_number,\n                \"phoneNumber\": data[0].user_phone_number,\n                \"line\": data[0].user_line,\n                \"whatsapp\": data[0].user_whatsapp,\n                \"facebook\": data[0].user_facebook,\n                \"instagram\": data[0].user_instagram,\n                \"wechat\": data[0].user_wechat,\n                \"country\": data[0].user_country,\n                \"address1\": data[0].user_address1,\n                \"address2\": data[0].user_address2,\n                \"language\": data[0].user_language,\n                \"ranking\": data[0].rank,\n                \"url\": \"https://morichworldwide.com/\"+data[0].user_username\n              });\n\n              return res.status(200).json({statusCode:200,success:true,data:dt[0]});\n            }\n        });\n     });\n  };\n\n  this.userGetIdByEmail = function(req,res,next) {\n      var email = req.query.email;\n\n      connection.acquire(function(err,con){\n        if (err) throw err;\n\n        userModel.getUserIdByEmail(con,email,res,function(result){\n\n          var userId = result.userId;\n          return res.status(200).json({statusCode:200,success:true,data:{\"userId\":userId}});\n\n        });\n        con.release();\n      }); \n  };\n\n  this.userStatisticByEmail = function(req,res,next) {\n    var email = req.query.email;\n\n    if(empty(email))\n      return res.status(500).json({statusCode:500,message: \"Parameter email is required\"});\n\n    connection.acquire(function(err,con){\n      if (err) throw err;\n        con.query('SELECT user_id as id, (select count(user_id) from users WHERE user_invited_by = id) as total_invited, \\\n          (select count(user_id) from users WHERE user_invited_by = id AND status <> 0) as member_joined, FIND_IN_SET( user_point, (SELECT GROUP_CONCAT( user_point ORDER BY user_point DESC ) FROM users )) \\\n          AS rank FROM users WHERE user_email=\"'+req.query.email+'\" LIMIT 1', function(err,data){\n          con.release();\n          if(err)\n              return res.status(500).json({statusCode:500,message: err.code});\n\n          if(data.length < 1){\n            res.status(404).json({statusCode:404,message: \"Data not found\"});\n          }else{\n            \n            var dt = [];\n\n            dt.push({\n              \"ranking\": data[0].rank,\n              \"totalInvited\": data[0].total_invited,\n              \"memberJoined\": data[0].member_joined\n            });\n\n            return res.status(200).json({statusCode:200,success:true,data:dt[0]});\n          }\n      });\n    \n    });\n  };\n\n  this.userUpdate = function(req,res,next) {\n\n    if( empty(req.body.firstName) && empty(req.body.email) && empty(req.body.mobileNumber) && empty(req.body.address1) )\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"}); \n     \n    var firstName = req.body.firstName,\n        lastName = req.body.lastName,\n        language = req.body.language,\n        email = req.body.email,\n        mobileNumber = req.body.mobileNumber,\n        phoneNumber = req.body.phoneNumber,\n        line = req.body.line,\n        whatsapp = req.body.whatsapp,\n        facebook = req.body.facebook,\n        instagram = req.body.instagram,\n        wechat = req.body.wechat,\n        country = req.body.country,\n        address1 = req.body.address1,\n        address2 = req.body.address2;\n\n    connection.acquire(function(err,con){\n      if (err) throw err;\n\n      var sql = \"UPDATE users set user_firstname = '\"+firstName+\"', user_lastname = '\"+lastName+\"' \\\n      ,user_language = '\"+language+\"' ,user_mobile_number = '\"+mobileNumber+\"' ,user_phone_number = '\"+phoneNumber+\"' \\\n      ,user_line = '\"+line+\"' \\\n      ,user_whatsapp = '\"+whatsapp+\"' \\\n      ,user_facebook = '\"+facebook+\"' \\\n      ,user_instagram = '\"+instagram+\"' \\\n      ,user_wechat = '\"+wechat+\"' \\\n      ,user_country = '\"+country+\"' \\\n      ,user_address1 = '\"+address1+\"' \\\n      ,user_address2 = '\"+address2+\"' \\\n      ,update_date = NOW() WHERE user_email = '\"+email+\"'\";\n        \n      con.query(sql, function(err,data){\n          \n          if(err)\n            return res.status(500).json({statusCode:500,message: err.code});\n          \n          userModel.getUserIdByEmail(con,email,res,function(result){\n            var userId = result.userId;\n            return res.status(200).json({statusCode:200,success:true,data:{\"userId\":userId}});\n          });\n      });\n\n      con.release();\n\n    });\n    \n  };\n\n  this.userUploadPhoto = function(req,res,next) {\n\n    if( empty(req.body.email) )\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"}); \n     \n    var photoProfile = req.file.filename;\n    var email = req.body.email;\n\n    connection.acquire(function(err,con){\n      if (err) throw err;\n\n      userModel.getUserIdByEmail(con,email,res,function(result){\n\n        var userId = result.userId;\n\n        var sql = \"UPDATE users set user_photo = '\"+photoProfile+\"' \\\n        ,update_date = NOW() WHERE user_id= '\"+userId+\"'\";\n\n        con.query(sql, function(err,data){\n          \n          if(err)\n            return res.status(500).json({statusCode:500,message: err.code});\n          \n          return res.status(200).json({statusCode:200,success:true,data:{\"userId\":userId,\"photoFilename\":photoProfile}});\n        });\n      });\n\n      con.release();\n\n    });\n\n  };\n\n  this.uploadAction = upload.single('image');\n\n  this.userSubmission = function(req,res,next) {\n    \n    var referralEmail = req.body.referralEmail,\n        fullName = req.body.fullName,\n        email = req.body.email,\n        hpWa = req.body.hpWa,\n        city = req.body.city,\n        age = req.body.age,\n        languages = req.body.languages,\n        currentOccupation = req.body.currentOccupation,\n        isExperienceInMobileBusiness = req.body.isExperienceInMobileBusiness,\n        targetMobileBusiness180Days = req.body.targetMobileBusiness180Days,\n        reason = req.body.reason,\n        urgencyLevel = req.body.urgencyLevel,\n        seriousLevel = req.body.seriousLevel,\n        capitalInvestment = req.body.capitalInvestment,\n        readyToJoin = req.body.readyToJoin,\n        isAvailableContactToMobile = req.body.isAvailableContactToMobile;\n\n    if( empty(referralEmail) || empty(fullName) || empty(email) || empty(hpWa) \n      || empty(city) || empty(age) || empty(languages) || empty(currentOccupation) || \n      empty(isExperienceInMobileBusiness) || empty(targetMobileBusiness180Days) || empty(reason) || empty(urgencyLevel) || \n      empty(seriousLevel) || empty(capitalInvestment) || empty(readyToJoin) || empty(isAvailableContactToMobile) ){\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"});  \n    }\n\n    emailModel.sendEmailSubmission(req.body);\n    return res.status(200).json({statusCode:200,success:true});\n\n  };\n\n  this.userSubmissionBackup = function(req,res,next) {\n    \n    var userId = req.body.userId,\n        fullName = req.body.fullName,\n        email = req.body.email,\n        hpWa = req.body.hpWa,\n        city = req.body.city,\n        age = req.body.age,\n        languages = req.body.languages,\n        currentOccupation = req.body.currentOccupation,\n        isExperienceInMobileBusiness = req.body.isExperienceInMobileBusiness,\n        targetMobileBusiness180Days = req.body.targetMobileBusiness180Days,\n        reason = req.body.reason,\n        urgencyLevel = req.body.urgencyLevel,\n        seriousLevel = req.body.seriousLevel,\n        capitalInvestment = req.body.capitalInvestment,\n        readyToJoin = req.body.readyToJoin,\n        isAvailableContactToMobile = req.body.isAvailableContactToMobile;\n\n    if( empty(userId) || empty(fullName) || empty(email) || empty(hpWa) \n      || empty(city) || empty(age) || empty(languages) || empty(currentOccupation) || \n      empty(isExperienceInMobileBusiness) || empty(targetMobileBusiness180Days) || empty(reason) || empty(urgencyLevel) || \n      empty(seriousLevel) || empty(capitalInvestment) || empty(readyToJoin) || empty(isAvailableContactToMobile) ){\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"});  \n    }\n\n\n    connection.acquire(function(err,con){\n      if (err) throw err;\n\n      var sql = \"INSERT INTO application_submission (user_id,fullname,email,hp_wa,languages,city,age,\\\n                current_occupation, is_experience_mobile_business, target_mobile_business_180_days,\\\n                reason,urgency_level,serious_level,capital_investment,ready_to_join,is_available_contact_to_mobile,post_date)\\\n                VALUES ('\"+userId+\"', '\"+fullName+\"', '\"+email+\"', '\"+hpWa+\"', '\"+languages+\"', '\"+city+\"', '\"+age+\"', \\\n                '\"+currentOccupation+\"', '\"+isExperienceInMobileBusiness+\"', '\"+targetMobileBusiness180Days+\"', '\"+reason+\"', '\"+urgencyLevel+\"', '\"+seriousLevel+\"', '\"+capitalInvestment+\"', \\\n                '\"+readyToJoin+\"', '\"+isAvailableContactToMobile+\"', NOW())\";\n\n                console.log(sql);\n        \n      con.query(sql, function(err,data){\n          con.release();\n          if(err)\n            return res.status(500).json({statusCode:500,message: err.code});\n\n          return res.status(200).json({statusCode:200,success:true,data:{\"submissionId\":data.insertId,\"userId\":userId}});\n      });\n    });  \n  };\n\n  this.userList = function(req,res,next) {\n     connection.acquire(function(err,con){\n        if (err) throw err;\n\n          var sql = 'SELECT u.*, s.*, u.user_id as userID, u.post_date as postDate, s.post_date as submit_app_date, u.user_id as id, \\\n          u.user_invited_by as invited_id, \\\n          (select count(user_id) from users WHERE user_invited_by = id) as total_invited, \\\n          (select user_email FROM users WHERE user_id = invited_id) as inviter_email, \\\n          (select count(user_id) from users WHERE user_invited_by = id AND status <> \"0\") as member_joined, \\\n          FIND_IN_SET( user_point, (SELECT GROUP_CONCAT( user_point ORDER BY user_point DESC ) FROM users )) \\\n          AS rank FROM users u LEFT JOIN application_submission s ON u.user_email = s.email'\n          \n          //console.log(sql);\n          con.query(sql, function(err,data){\n            con.release();\n            if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n            \n            var dt = [];\n            for (var i = 0; i < data.length; i++) {\n              var pp = (data[i].user_photo) ? cfg.photoProfileUrl+''+data[i].user_photo : null;\n\n              var fullName = data[i].user_firstname+' '+data[i].user_lastname;\n\n              var splitName = fullName.trim().split(\" \");\n\n              if(splitName.length > 1){\n                var initialName = splitName[0].charAt(0)+''+splitName[1].charAt(0);\n              }else{\n                var initialName = splitName[0].charAt(0);\n              }\n\n              initialName = initialName.toUpperCase();\n\n              var statusAccount = \"\";\n\n              if(data[i].status == 0){\n                statusAccount = \"not active\";\n              }\n\n              if(data[i].status == 1){\n                statusAccount = \"regular\";\n              }\n\n              if(data[i].status == 2){\n                statusAccount = \"potential\";\n              }\n\n              if(data[i].status == 3){\n                statusAccount = \"premium\";\n              }\n\n              var app = [];\n              if(!empty(data[i].user_id)){\n                app = {\n                  \"city\": data[i].city,\n                  \"age\": data[i].age,\n                  \"occupation\": data[i].current_occupation,\n                  \"isExperienceInMobileBusiness\": data[i].is_experience_mobile_business,\n                  \"targetMobileBusiness180Days\": data[i].target_mobile_business_180_days,\n                  \"reason\": data[i].reason,\n                  \"urgencyLevel\": data[i].urgency_level,\n                  \"seriousLevel\": data[i].serious_level,\n                  \"capitalInvestment\": data[i].capital_investment,\n                  \"readyToJoin\": data[i].ready_to_join,\n                  \"isAvailableContactToMobile\": data[i].is_available_contact_to_mobile,\n                  \"submitAppDate\": data[i].submit_app_date\n                }\n              }\n\n              dt.push({\n                \"userId\": data[i].userID,\n                \"password\": empty(data[i].user_password) ? \"false\" : \"true\",\n                \"email\": data[i].user_email,\n                \"firstName\": data[i].user_firstname,\n                \"lastName\": data[i].user_lastname,\n                \"initialName\": initialName,\n                \"photoUrl\": pp,\n                \"mobileNumber\": data[i].user_mobile_number,\n                \"phoneNumber\": data[i].user_phone_number,\n                \"line\": data[i].user_line,\n                \"whatsapp\": data[i].user_whatsapp,\n                \"facebook\": data[i].user_facebook,\n                \"instagram\": data[i].user_instagram,\n                \"wechat\": data[i].user_wechat,\n                \"country\": data[i].user_country,\n                \"address1\": data[i].user_address1,\n                \"address2\": data[i].user_address2,\n                \"language\": data[i].user_language,\n                \"ranking\": data[i].rank,\n                \"url\": \"https://morichworldwide.com/\"+data[i].user_username,\n                \"totalInvited\": data[i].total_invited,\n                \"memberJoined\": data[i].member_joined,\n                \"emailInviter\": data[i].inviter_email,\n                \"accountStatus\": statusAccount,\n                \"inviterId\": data[i].user_invited_by,\n                \"postDate\": data[i].postDate,\n                \"city\": data[i].city,\n                \"age\": data[i].age,\n                \"occupation\": data[i].current_occupation,\n                \"isExperienceInMobileBusiness\": data[i].is_experience_mobile_business,\n                \"targetMobileBusiness180Days\": data[i].target_mobile_business_180_days,\n                \"reason\": data[i].reason,\n                \"urgencyLevel\": data[i].urgency_level,\n                \"seriousLevel\": data[i].serious_level,\n                \"capitalInvestment\": data[i].capital_investment,\n                \"readyToJoin\": data[i].ready_to_join,\n                \"isAvailableContactToMobile\": data[i].is_available_contact_to_mobile,\n                \"submitAppDate\": data[i].submit_app_date\n              });\n            }\n            return res.status(200).json({statusCode:200,success:true,data:dt});\n          });\n      });\n  };\n\n  this.userListBackup = function(req,res,next) {\n     connection.acquire(function(err,con){\n        if (err) throw err;\n\n          var sql = 'SELECT u.*, s.*, u.user_id as userID, u.post_date as postDate, s.post_date as submit_app_date, u.user_id as id, \\\n          u.user_invited_by as invited_id, \\\n          (select count(user_id) from users WHERE user_invited_by = id) as total_invited, \\\n          (select user_email FROM users WHERE user_id = invited_id) as inviter_email, \\\n          (select count(user_id) from users WHERE user_invited_by = id AND status <> \"0\") as member_joined, \\\n          FIND_IN_SET( user_point, (SELECT GROUP_CONCAT( user_point ORDER BY user_point DESC ) FROM users )) \\\n          AS rank FROM users u LEFT JOIN application_submission s ON u.user_id = s.user_id'\n          \n          //console.log(sql);\n          con.query(sql, function(err,data){\n            con.release();\n            if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n            \n            var dt = [];\n            for (var i = 0; i < data.length; i++) {\n              var pp = (data[i].user_photo) ? cfg.photoProfileUrl+''+data[i].user_photo : null;\n\n              var fullName = data[i].user_firstname+' '+data[i].user_lastname;\n\n              var splitName = fullName.trim().split(\" \");\n\n              if(splitName.length > 1){\n                var initialName = splitName[0].charAt(0)+''+splitName[1].charAt(0);\n              }else{\n                var initialName = splitName[0].charAt(0);\n              }\n\n              initialName = initialName.toUpperCase();\n\n              var statusAccount = \"\";\n\n              if(data[i].status == 0){\n                statusAccount = \"not active\";\n              }\n\n              if(data[i].status == 1){\n                statusAccount = \"regular\";\n              }\n\n              if(data[i].status == 2){\n                statusAccount = \"potential\";\n              }\n\n              if(data[i].status == 3){\n                statusAccount = \"premium\";\n              }\n\n              var app = [];\n              if(!empty(data[i].user_id)){\n                app = {\n                  \"city\": data[i].city,\n                  \"age\": data[i].age,\n                  \"occupation\": data[i].current_occupation,\n                  \"isExperienceInMobileBusiness\": data[i].is_experience_mobile_business,\n                  \"targetMobileBusiness180Days\": data[i].target_mobile_business_180_days,\n                  \"reason\": data[i].reason,\n                  \"urgencyLevel\": data[i].urgency_level,\n                  \"seriousLevel\": data[i].serious_level,\n                  \"capitalInvestment\": data[i].capital_investment,\n                  \"readyToJoin\": data[i].ready_to_join,\n                  \"isAvailableContactToMobile\": data[i].is_available_contact_to_mobile,\n                  \"submitAppDate\": data[i].submit_app_date\n                }\n              }\n\n              dt.push({\n                \"userId\": data[i].userID,\n                \"email\": data[i].user_email,\n                \"firstName\": data[i].user_firstname,\n                \"lastName\": data[i].user_lastname,\n                \"initialName\": initialName,\n                \"photoUrl\": pp,\n                \"mobileNumber\": data[i].user_mobile_number,\n                \"phoneNumber\": data[i].user_phone_number,\n                \"line\": data[i].user_line,\n                \"whatsapp\": data[i].user_whatsapp,\n                \"facebook\": data[i].user_facebook,\n                \"instagram\": data[i].user_instagram,\n                \"wechat\": data[i].user_wechat,\n                \"country\": data[i].user_country,\n                \"address1\": data[i].user_address1,\n                \"address2\": data[i].user_address2,\n                \"language\": data[i].user_language,\n                \"ranking\": data[i].rank,\n                \"url\": \"https://morichworldwide.com/\"+data[i].user_username,\n                \"totalInvited\": data[i].total_invited,\n                \"memberJoined\": data[i].member_joined,\n                \"emailInviter\": data[i].inviter_email,\n                \"accountStatus\": statusAccount,\n                \"inviterId\": data[i].user_invited_by,\n                \"postDate\": data[i].postDate,\n                \"city\": data[i].city,\n                \"age\": data[i].age,\n                \"occupation\": data[i].current_occupation,\n                \"isExperienceInMobileBusiness\": data[i].is_experience_mobile_business,\n                \"targetMobileBusiness180Days\": data[i].target_mobile_business_180_days,\n                \"reason\": data[i].reason,\n                \"urgencyLevel\": data[i].urgency_level,\n                \"seriousLevel\": data[i].serious_level,\n                \"capitalInvestment\": data[i].capital_investment,\n                \"readyToJoin\": data[i].ready_to_join,\n                \"isAvailableContactToMobile\": data[i].is_available_contact_to_mobile,\n                \"submitAppDate\": data[i].submit_app_date\n              });\n            }\n            return res.status(200).json({statusCode:200,success:true,data:dt});\n          });\n      });\n  };\n\n  this.activated = function(req,res,next) {\n     \n    var id = req.body.userId;\n    var email = req.body.email;\n    var inviterId = req.body.inviterId;\n    var isPassword = req.body.isPassword;\n    var status = req.body.status;\n\n    var point = \"\";\n\n    if(req.body.status == \"1\"){\n      point = 2;\n    }else{\n      point = 3;\n    }\n\n    console.log(req.body);\n\n\n    var sqlNew = \"UPDATE users set status = '\"+req.body.status+\"' \\\n      , update_date = NOW() WHERE user_id = '\"+id+\"' \";\n    var oriPassword = generalModel.getRandomStr();\n    \n    if(isPassword == \"false\"){\n      var password = bcrypt.hashSync(oriPassword, 10);\n      var sqlNew = \"UPDATE users set status = '\"+req.body.status+\"' \\\n      ,user_password = '\"+password+\"', update_date = NOW() WHERE user_id = '\"+id+\"' \";\n    }\n\n\n    connection.acquire(function(err,con){\n      if (err) throw err;\n\n      var sql = sqlNew;\n\n      console.log(sql);\n        \n      con.query(sql, function(err,data){\n          if(err)\n            return res.status(500).json({statusCode:500,message: err.code});\n\n          if(data.affectedRows == 0)\n            return res.status(500).json({statusCode:500,message: \"either 'email' or 'invitedBy' wrong\"});\n\n          userModel.updatePoint(con,inviterId,point,res,function(result){\n            \n            if(isPassword == \"false\"){\n              emailModel.sendTmpPassword(email,oriPassword,status);\n            }\n\n            return res.status(200).json({statusCode:200,success:true});\n          });\n      });\n      con.release();\n    });\n  };\n\n  this.userAdminPost = function(req,res,next) {\n\n    console.log(req.body);\n\n    if( empty(req.body.firstName) || empty(req.body.lastName) || empty(req.body.mobileNumber) || empty(req.body.email) )\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"}); \n     \n    var email = req.body.email,\n        firstName = req.body.firstName,\n        lastName = req.body.lastName,\n        mobileNumber = req.body.mobileNumber,\n        referralEmail = req.body.referralEmail,\n        statusAccount = req.body.status,\n        password = generalModel.getRandomStr(),\n        passwordEncrypt = bcrypt.hashSync(password, 10);\n\n    if(empty(referralEmail)){\n      referralEmail = \"root\";\n    }\n\n    var point = \"\";\n\n    if(statusAccount == \"1\"){\n      point = 2;\n    }else{\n      point = 3;\n    }\n    \n    connection.acquire(function(err,con){\n      if (err) throw err;\n\n      userModel.checkEmailExist(con,email,res,function(result){\n\n        userModel.getUserIdByEmail(con,referralEmail,res,function(result){\n\n          var userIdReferral = result.userId; \n          console.log(userIdReferral);\n\n          var sql = \"INSERT INTO users (user_email,user_password,user_firstname,user_lastname,user_mobile_number,user_invited_by,post_date) \\\n                        VALUES ('\"+email+\"', '\"+passwordEncrypt+\"', '\"+firstName+\"', '\"+lastName+\"', '\"+mobileNumber+\"','\"+userIdReferral+\"',NOW())\";\n                \n          con.query(sql, function(err,data){\n              \n              if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n\n\n              var fullName = firstName+' '+lastName;\n              var splitName = fullName.trim().split(\" \");\n\n              if(splitName.length > 1){\n                var uname = splitName[0]+''+data.insertId;\n              }else{\n                var uname = splitName[0]+''+data.insertId;\n              }\n\n              uname = uname.toLowerCase();\n\n              var userId = data.insertId;; \n              \n              var sql2 = \"UPDATE users set user_username = '\"+uname+\"', status = '\"+statusAccount+\"', update_date = NOW() WHERE user_email = '\"+email+\"'\";\n            \n              con.query(sql2, function(err2,data2){\n                if(err2)\n                  return res.status(500).json({statusCode:500,message: err2.code});\n\n                if(referralEmail != 'root'){\n                  var sql2 = \"INSERT INTO conversations (UserID_One, UserID_Two, UserOneStatus, UserTwoStatus, \\\n                          TransactTime) \\\n                          VALUES ('\"+email+\"','\"+referralEmail+\"','2','2', NOW())\";\n\n                  con.query(sql2, function(err2,data2){\n                    if(err2)\n                      return res.status(500).json({statusCode:500,message: err2.code});\n\n                      userModel.updatePointByEmail(con,referralEmail,point,res,function(result){\n                        emailModel.sendEmailUserRegisterFromAdmin(email,fullName,password);\n                        return res.status(200).json({statusCode:200,success:true,data:{\"userId\":userId}});\n                      });\n                  });\n                }else{\n                  emailModel.sendEmailUserRegisterFromAdmin(email,fullName,password);\n                  return res.status(200).json({statusCode:200,success:true,data:{\"userId\":userId}});\n                }\n  \n              });\n          });\n        });\n      });\n      con.release();\n    });\n  };\n\n  this.userAdminPostBackup = function(req,res,next) {\n\n    if( empty(req.body.firstName) || empty(req.body.lastName) || empty(req.body.mobileNumber) || empty(req.body.email) )\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"}); \n     \n    var email = req.body.email,\n        firstName = req.body.firstName,\n        lastName = req.body.lastName,\n        mobileNumber = req.body.mobileNumber,\n        password = generalModel.getRandomStr(),\n        passwordEncrypt = bcrypt.hashSync(password, 10);\n    \n    connection.acquire(function(err,con){\n      if (err) throw err;\n\n      userModel.checkEmailExist(con,email,res,function(result){ \n\n        var sql = \"INSERT INTO users (user_email,user_password,user_firstname,user_lastname,user_mobile_number,user_invited_by,post_date) \\\n                      VALUES ('\"+email+\"', '\"+passwordEncrypt+\"', '\"+firstName+\"', '\"+lastName+\"', '\"+mobileNumber+\"','root',NOW())\";\n              \n        con.query(sql, function(err,data){\n            \n            if(err)\n              return res.status(500).json({statusCode:500,message: err.code});\n\n\n            var fullName = firstName+' '+lastName;\n            var splitName = fullName.trim().split(\" \");\n\n            if(splitName.length > 1){\n              var uname = splitName[0]+''+data.insertId;\n            }else{\n              var uname = splitName[0]+''+data.insertId;\n            }\n\n            uname = uname.toLowerCase();\n\n            var userId = data.insertId;; \n            \n            var sql2 = \"UPDATE users set user_username = '\"+uname+\"', status = 3, update_date = NOW() WHERE user_email = '\"+email+\"'\";\n          \n            con.query(sql2, function(err2,data2){\n              if(err2)\n                return res.status(500).json({statusCode:500,message: err2.code});\n\n              emailModel.sendEmailUserRegisterFromAdmin(email,fullName,password);\n              return res.status(200).json({statusCode:200,success:true,data:{\"userId\":userId}});  \n            });\n        });\n        con.release();\n      })\n    });\n  };\n\n  this.userChangePassword = function(req,res,next) {\n\n    if( empty(req.body.email) || empty(req.body.password) || empty(req.body.retypePassword) )\n      return res.status(500).json({statusCode:500,message: \"Please check your parameter or value required\"}); \n     \n    var email = req.body.email,\n        password = bcrypt.hashSync(req.body.password, 10),\n        retypePassword = req.body.retypePassword;\n\n    if(req.body.password != req.body.retypePassword)\n      return res.status(500).json({statusCode:500,message: \"Password doesn't match\"});\n\n    connection.acquire(function(err,con){\n        \n      var sql = \"UPDATE users set user_password = '\"+password+\"', update_date = NOW() WHERE user_email = '\"+email+\"'\";\n        \n      con.query(sql, function(err,data){\n        con.release();\n        if(err)\n          return res.status(500).json({statusCode:500,message: err.code});\n\n          return res.status(200).json({statusCode:200,success:true}); \n      });\n    });\n  };\n}\n\nmodule.exports = new cUser();"]}