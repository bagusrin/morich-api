{"version":3,"sources":["../src/app/controllers/spiderman.js"],"names":["connection","require","jwt","bcrypt","userModel","cSpiderman","spidermanList","req","res","next","acquire","err","con","query","data","release","status","json","statusCode","message","code","dt","i","length","push","spiderman_id","spiderman_email","spiderman_name","spiderman_level","success","spidermanDetail","params","id","spidermanRegister","email","body","password","hashSync","name","level","sql","spidermanLogin","comparePassword","spiderman_password","module","exports"],"mappings":"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","file":"spiderman.js","sourcesContent":["var connection = require('../../../config/db');\n\nvar jwt = require('jsonwebtoken'),\n    bcrypt = require('bcrypt'),\n    userModel = require('../models/user');\n \nfunction cSpiderman() {\n \n  this.spidermanList = function(req,res,next) {\n     connection.acquire(function(err,con){\n        if (err) throw err;\n          con.query('SELECT * FROM spiderman', function(err,data){\n            con.release();\n            if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n               \n\n            var dt = [];\n            for (var i = 0; i < data.length; i++) {\n                dt.push({\n                  \"id\": data[i].spiderman_id,\n                  \"email\": data[i].spiderman_email,\n                  \"name\": data[i].spiderman_name,\n                  \"level\": data[i].spiderman_level\n                });\n            } \n\n            return res.status(200).json({\n                                    statusCode:200,\n                                    success:true,\n                                    data:dt\n                                });\n   \n        });\n     });\n  };\n\n  this.spidermanDetail = function(req,res,next) {\n     connection.acquire(function(err,con){\n        if (err) throw err;\n          con.query('SELECT * FROM spiderman WHERE spiderman_id='+req.params.id+' LIMIT 1', function(err,data){\n            con.release();\n            if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n\n            if(data.length < 1){\n              res.status(404).json({statusCode:404,message: \"Data not found\"});\n            }else{\n              var dt = [];\n              dt.push({\n                \"id\": data[0].spiderman_id,\n                \"email\": data[0].spiderman_email,\n                \"name\": data[0].spiderman_name,\n                \"level\": data[0].spiderman_level\n              });\n\n              return res.status(200).json({\n                                      statusCode:200,\n                                      success:true,\n                                      data:dt[0]\n                                  });\n            }\n        });\n     });\n  };\n\n  this.spidermanRegister = function(req,res,next) {\n     connection.acquire(function(err,con){\n        if (err) throw err;\n\n          var email = req.body.email;\n          var password = bcrypt.hashSync(req.body.password, 10);\n          var name = req.body.name;\n          var level = 99;\n          var status = 1;\n\n          var sql = \"INSERT INTO spiderman (spiderman_email,spiderman_password,spiderman_name,spiderman_level,status) VALUES ('\"+email+\"', '\"+password+\"', '\"+name+\"', '\"+level+\"', '\"+status+\"')\";\n\n          con.query(sql, function(err,data){\n            con.release();\n            if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n               \n\n            return res.status(200).json({\n                                    statusCode:200,\n                                    success:true,\n                                    data:data\n                                });\n   \n        });\n     });\n  };\n\n  this.spidermanLogin = function(req,res,next) {\n     connection.acquire(function(err,con){\n        if (err) throw err;\n\n          var email = req.body.email;\n          var password = req.body.password;\n\n          var sql = \"SELECT * FROM spiderman WHERE spiderman_email = '\"+email+\"'\";\n\n          con.query(sql, function(err,data){\n            con.release();\n            if(err)\n                return res.status(500).json({statusCode:500,message: err.code});\n               \n            if (!userModel.comparePassword(password,data[0].spiderman_password)) {\n                  return res.status(401).json({statusCode:500, message: 'Authentication failed. Invalid admin or password.' });\n            }\n\n            var dt = [];\n            dt.push({\n              \"id\": data[0].spiderman_id,\n              \"email\": data[0].spiderman_email,\n              \"name\": data[0].spiderman_name,\n              \"level\": data[0].spiderman_level\n            });\n            \n            return res.status(200).json({\n                                    statusCode:200,\n                                    success:true,\n                                    data:dt[0]\n                                });\n   \n        });\n     });\n  };\n}\nmodule.exports = new cSpiderman();"]}